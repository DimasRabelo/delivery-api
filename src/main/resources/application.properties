# ===================================================================
# CONFIGURAÇÃO H2 DATABASE (EM MEMÓRIA)
# ===================================================================
# URL de conexão JDBC para o banco em memória chamado 'deliverydb'
spring.datasource.url=jdbc:h2:mem:deliverydb
# Driver JDBC do H2
spring.datasource.driver-class-name=org.h2.Driver
# Usuário padrão do banco H2
spring.datasource.username=sa
# Senha padrão do banco H2
spring.datasource.password=password

# ===================================================================
# H2 CONSOLE
# ===================================================================
# Habilita o console web do H2
spring.h2.console.enabled=true
# Define o caminho para acessar o console (ex: http://localhost:8080/h2-console)
spring.h2.console.path=/h2-console
# Permite que o console seja acessado de outras máquinas (não apenas localhost)
spring.h2.console.settings.web-allow-others=true

# ===================================================================
# JPA / HIBERNATE
# ===================================================================
# Define o dialeto SQL específico para o banco H2
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
# 'create-drop': O Hibernate irá criar o schema no início e derrubá-lo no final.
spring.jpa.hibernate.ddl-auto=create-drop
# Garante que os scripts (data.sql) rodem APÓS a criação do schema pelo Hibernate
spring.jpa.defer-datasource-initialization=true
# Mostra no console o SQL que o Hibernate está executando
spring.jpa.show-sql=true
# Formata o SQL logado para ser mais legível
spring.jpa.properties.hibernate.format_sql=true
# Adiciona comentários ao SQL logado (ex: de qual método Java a query veio)
spring.jpa.properties.hibernate.use_sql_comments=true
# 'false' é a melhor prática: Evita o "Open Session in View",
spring.jpa.open-in-view=false
# Habilita o processamento em lote (batch) para inserts/updates
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ===================================================================
# INICIALIZAÇÃO DE SCRIPTS SQL (data.sql, schema.sql)
# ===================================================================
# 'always': Sempre executa os scripts de inicialização (data.sql)
spring.sql.init.mode=always

# ===================================================================
# CONFIGURAÇÃO JWT (JSON WEB TOKEN)
# ===================================================================
# Chave secreta para assinar os tokens.
app.jwt.secret=mySecretKey123456789012345678901234567890123456789012345678901234567890
# Tempo de expiração em milissegundos.
app.jwt.expiration-ms=6000000

# ===================================================================
# CONFIGURAÇÃO SWAGGER / OPENAPI
# ===================================================================
# Caminho para a definição JSON da API
springdoc.api-docs.path=/api-docs
# Caminho para a interface gráfica do Swagger
springdoc.swagger-ui.path=/swagger-ui.html
# Ordena as operações (endpoints) por método (DELETE, GET, POST, PUT)
springdoc.swagger-ui.operationsSorter=method
# Ordena as Tags (Controllers) alfabeticamente
springdoc.swagger-ui.tagsSorter=alpha
# Habilita o botão "Try It Out" na interface do Swagger UI
springdoc.swagger-ui.tryItOutEnabled=true
# Habilita o filtro de busca na interface do Swagger UI
springdoc.swagger-ui.filter=true
# Habilita os endpoints do OpenAPI e Swagger UI
springdoc.api-docs.enabled=true
# Habilita a interface do Swagger UI
springdoc.swagger-ui.enabled=true
# Configurações OAuth2 para o Swagger UI (usado com JWT Bearer Token)
springdoc.swagger-ui.oauth.clientId=swagger-ui
springdoc.swagger-ui.oauth.realm=swagger-ui-realm
springdoc.swagger-ui.oauth.appName=swagger-ui
# Configura CORS para permitir requisições de qualquer origem
spring.web.cors.allowed-origins=*
# Configura CORS para permitir todos os métodos HTTP
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
# Configura CORS para permitir todos os headers
spring.web.cors.allowed-headers=*

# ===================================================================
# USUÁRIO PADRÃO (INATIVO)
# ===================================================================
# As linhas abaixo definem o usuário Basic Auth padrão do Spring Boot.
# Elas estão INATIVAS e sendo IGNORADAS, pois o SecurityConfig.java
# customizado (com securityFilterChain) toma prioridade.
# spring.security.user.name=admin
# spring.security.user.password=admin

# ===================================================================
# CONFIGURAÇÃO DE LOGGING
# ===================================================================
# Logs de SQL e transações (ótimos para debug)
logging.level.org.hibernate.SQL=DEBUG
# Nível TRACE mostra os valores sendo "bindados" (setados) nas queries SQL
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.transaction=DEBUG
logging.level.org.springdoc=DEBUG
logging.level.org.springframework.web=DEBUG

# Logs principais da aplicação
logging.level.org.springframework.security=DEBUG
logging.level.com.deliverytech=DEBUG

# ===================================================================
# CONFIGURAÇÃO DO SERVIDOR
# ===================================================================
server.port=8080

# ===================================================================
# ===================================================================
# ATIVIDADE 1 & 2: MONITORAMENTO (ACTUATOR & PROMETHEUS)
# ===================================================================
# ===================================================================

# Define o caminho base para todos os endpoints do Actuator
# Ex: http://localhost:8080/actuator/health
management.endpoints.web.base-path=/actuator

# Expõe (torna públicos) os endpoints específicos.
# O gabarito pedia "health,info,metrics,prometheus,env,loggers"
# NOTA: Expor 'env' e 'loggers' é um RISCO DE SEGURANÇA em produção.
# Estamos fazendo isso para a atividade, mas eles devem ser protegidos.
management.endpoints.web.exposure.include=health,info,metrics,prometheus,env,loggers

# Configura o CORS especificamente para os endpoints do Actuator
# Isso permite que ferramentas externas (como um dashboard) acessem esses endpoints
management.endpoints.cors.allowed-origins=*
management.endpoints.cors.allowed-methods=GET,POST

# ===================================================================
# ENDPOINT /actuator/health
# ===================================================================
# 'always': Sempre mostra detalhes completos no health check
# (componentes, status, erros)
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
# Habilita os health checks padrão (que já vêm com o Spring)
management.health.diskspace.enabled=true
management.health.diskspace.threshold=10GB
management.health.db.enabled=true

# ===================================================================
# ENDPOINT /actuator/info
# ===================================================================
# Habilita os contribuidores de informação padrão
info.env.enabled=true
info.git.mode=full
info.build.enabled=true

# Adiciona informações customizadas da aplicação ao /actuator/info
# (Estas são as informações do gabarito)
info.app.name=Sistema de Delivery (Projeto Atividade)
info.app.description=API REST para sistema de delivery com observabilidade
info.app.version=1.0.0
info.app.encoding=UTF-8
info.java.version=17
info.team.name=Equipe de Desenvolvimento
info.team.email=dev@delivery.com

# ===================================================================
# ENDPOINT /actuator/prometheus
# ===================================================================
# Habilita o endpoint do Prometheus
management.endpoint.prometheus.enabled=true

# ==========================================================
# ATIVIDADE 4.1: DISTRIBUTED TRACING (Micrometer Tracing)
# ==========================================================

# Define a probabilidade de "samplear" (gravar) um trace. 1.0 = 100% (ótimo para dev)
management.tracing.sampling.probability=1.0

# Configura o endpoint do Zipkin (servidor de visualização de traces)
# (O gabarito pedia a URL do Zipkin, então mantemos a configuração)
management.zipkin.tracing.endpoint=http://localhost:9411/api/v2/spans